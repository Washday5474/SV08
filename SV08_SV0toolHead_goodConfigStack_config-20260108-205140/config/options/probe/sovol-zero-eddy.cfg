[probe_eddy_current btt_eddy]
sensor_type: ldc1612
z_offset: 2.0 
i2c_mcu: extruder_mcu
i2c_software_scl_pin: extruder_mcu:PB10
i2c_software_sda_pin: extruder_mcu:PB11
x_offset: -19.8
y_offset: -0.75

[bed_mesh]
speed: 200
horizontal_move_z: 2
mesh_min: 25,25
mesh_max: 330,330
probe_count: 15,15
algorithm: bicubic
scan_overshoot: 8
adaptive_margin: 5

[homing_override]
gcode:
    # 1. Safety Lift
    G91
    G0 Z10 F1000 
    G90
    
    # 2. Home Y (Back) First
    {% if not rawparams or 'Y' in rawparams %}
        G28 Y
    {% endif %}
    
    # 3. Home X (Side) Second
    {% if not rawparams or 'X' in rawparams %}
        G28 X
    {% endif %}
    
    # 4. NOW move to Center (Safe because X and Y are known)
    {% if not rawparams or 'Z' in rawparams %}
        G0 X177.5 Y177.5 F6000
        G28 Z
        G0 Z10 F1000
        PROBE
        SET_Z_FROM_PROBE
    {% endif %}
axes: xyz
set_position_z: 0

[gcode_macro SET_Z_FROM_PROBE]
gcode:
    {% set cf = printer.configfile.settings %}
    # Changed SET_GCODE_OFFSET_ORIG to SET_GCODE_OFFSET
    SET_GCODE_OFFSET Z={printer.probe.last_z_result - cf['probe_eddy_current btt_eddy'].z_offset}

[gcode_macro PROBE_EDDY_CURRENT_CALIBRATE_AUTO]
gcode:
    BED_MESH_CLEAR
    G28 X Y
    G90
    G1 X{ printer.toolhead.axis_maximum.x/2 } Y{ printer.toolhead.axis_maximum.y/2 } F6000
    {% if 'z' not in printer.toolhead.homed_axes %}
        SET_KINEMATIC_POSITION Z={ printer.toolhead.axis_maximum.z-1 }
    {% endif %}
    PROBE_EDDY_CURRENT_CALIBRATE {rawparams}